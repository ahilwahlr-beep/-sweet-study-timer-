<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üç≠ Custom Study: Pou Edition üç≠</title>
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <style>
        :root {
            --gingham-pink: #FF85A1;
            --sidebar-purple: #D8B4FE;
            --button-pink: #FF4D8D;
            --text-dark: #4A1D33;
            --white: #ffffff;
        }

        body { margin: 0; font-family: 'VT323', monospace; display: flex; height: 100vh; overflow: hidden; background-color: var(--white); color: var(--text-dark); }
        #main-wrapper { display: flex; width: 100%; height: 100%; flex-direction: row; }

        @media (max-width: 768px) {
            #main-wrapper { flex-direction: column; overflow-y: auto; }
            body { overflow-y: auto; }
            .room-area { min-height: 400px; flex: none; }
            .sidebar { flex: none; height: auto; border-left: none; border-top: 6px solid var(--text-dark); padding-bottom: 50px; }
        }

        .room-area { 
            flex: 1.8; position: relative; display: flex; flex-direction: column; justify-content: flex-end; align-items: center; 
            background-image: linear-gradient(90deg, rgba(255, 133, 161, 0.4) 50%, transparent 50%), linear-gradient(rgba(255, 133, 161, 0.4) 50%, transparent 50%); 
            background-size: 50px 50px; 
        }
        .floor { width: 100%; height: 15%; background-color: #FDF2F8; border-top: 6px solid var(--button-pink); position: absolute; bottom: 0; z-index: 1; }
        
        .pou-container { z-index: 10; margin-bottom: 30px; animation: bounce 3s infinite ease-in-out; cursor: pointer; position: relative; }
        .eating { animation: chew 0.3s ease-in-out !important; }

        .pou { width: 250px; height: 220px; background-color: #FFC0CB; border: 6px solid var(--text-dark); border-radius: 50% 50% 45% 45% / 65% 65% 40% 40%; position: relative; box-shadow: 10px 10px 0 rgba(0,0,0,0.1); }
        .pou::before { content: ''; position: absolute; width: 35px; height: 35px; background: #222; border-radius: 50%; top: 60px; left: 55px; box-shadow: 100px 0 #222; }
        .pou-blush { position: absolute; width: 45px; height: 18px; background: #FF1493; border-radius: 50%; top: 110px; left: 40px; box-shadow: 125px 0 #FF1493; opacity: 0.5; pointer-events: none; }
        .mouth { position: absolute; width: 40px; height: 10px; border-bottom: 4px solid var(--text-dark); border-radius: 0 0 20px 20px; top: 115px; left: 50%; transform: translateX(-50%); }
        .eating .mouth { background: #4A1D33; width: 45px; height: 35px; border-radius: 50%; border: none; }

        .accessory-slot { font-size: 70px; position: absolute; top: -45px; left: 50%; transform: translateX(-50%); z-index: 20; filter: drop-shadow(3px 3px 0px white); pointer-events: none; }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }
        @keyframes chew { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } }

        .sidebar { flex: 1; background-color: var(--sidebar-purple); border-left: 6px solid var(--text-dark); padding: 15px; display: flex; flex-direction: column; gap: 12px; overflow-y: auto; }
        .candy-box { background-color: #FFFF00; border: 4px solid var(--text-dark); padding: 10px; border-radius: 15px; text-align: center; font-size: 26px; font-weight: bold; box-shadow: 4px 4px 0 var(--text-dark); }
        .timer-display { font-size: 60px; text-align: center; color: var(--white); text-shadow: 4px 4px 0 var(--text-dark); margin: 5px 0; }
        
        .timer-input-area { display: flex; align-items: center; justify-content: center; gap: 10px; background: rgba(255,255,255,0.3); padding: 10px; border-radius: 10px; }
        .timer-input-area input { width: 50px; font-family: 'VT323'; font-size: 20px; text-align: center; border: 2px solid var(--text-dark); border-radius: 5px; }

        .btn-group { display: flex; gap: 8px; }
        button { background-color: var(--button-pink); color: white; border: 3px solid var(--text-dark); padding: 10px; font-family: 'VT323', monospace; font-size: 20px; cursor: pointer; border-radius: 12px; box-shadow: 3px 3px 0 var(--text-dark); flex: 1; }
        button:active { transform: translate(2px, 2px); box-shadow: 1px 1px 0 var(--text-dark); }
        button:disabled { background-color: #ccc; cursor: not-allowed; transform: none; box-shadow: none; }
        
        .day-card { background: var(--white); border: 3px solid var(--text-dark); border-radius: 10px; padding: 8px; margin-bottom: 6px; }
        .status-bubble { position: absolute; top: 15%; background: white; padding: 10px; border-radius: 15px; border: 4px solid var(--button-pink); display: none; z-index: 25; font-size: 22px; }

        .modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
        .modal-content { background: var(--white); padding: 20px; border: 6px solid var(--button-pink); border-radius: 25px; width: 85%; max-width: 320px; text-align: center; }
    </style>
</head>
<body>

    <div id="main-wrapper">
        <div class="room-area">
            <div id="bubble" class="status-bubble">Nyam! üç©</div>
            <div id="pou-character" class="pou-container" onclick="feedPou()">
                <div id="head-accessory" class="accessory-slot">üéÄ</div>
                <div class="pou">
                    <div class="pou-blush"></div>
                    <div class="mouth"></div>
                </div>
            </div>
            <div class="floor"></div>
        </div>

        <div class="sidebar">
            <div class="candy-box">üç≠ <span id="candy-count">0</span> CANDIES</div>
            
            <div class="timer-display" id="timer-display">00:00</div>
            
            <div class="timer-input-area">
                <span>Set:</span>
                <input type="number" id="custom-min" value="5" min="1" max="120">
                <span>Menit</span>
            </div>

            <div class="btn-group">
                <button id="btn-study" onclick="handleStart('study')">üìñ STUDY</button>
                <button id="btn-rest" style="background:#A855F7" onclick="handleStart('break')">‚òï REST</button>
            </div>

            <div class="btn-group">
                <button onclick="openModal('shop-modal')" style="background: #FACC15; color: black;">üõçÔ∏è SHOP</button>
                <button onclick="openModal('storage-modal')" style="background: #60A5FA; color: white;">üì¶ STORAGE</button>
            </div>

            <hr style="border: 2px dashed var(--text-dark);">
            
            <div style="display: flex; gap: 5px;">
                <select id="day-select" style="font-family: inherit; font-size: 18px; border: 2px solid var(--text-dark);">
                    <option value="senin">Sen</option><option value="selasa">Sel</option><option value="rabu">Rab</option><option value="kamis">Kam</option><option value="jumat">Jum</option><option value="sabtu">Sab</option><option value="minggu">Min</option>
                </select>
                <input type="text" id="task-input" placeholder="Tugas..." style="flex:1; font-family: inherit; padding: 5px; border: 2px solid var(--text-dark);">
                <button onclick="addTask()" style="flex:none; padding: 5px 15px;">+</button>
            </div>

            <div id="planner-list">
                <div class="day-card"><b>SENIN</b><div id="list-senin"></div></div>
                <div class="day-card"><b>SELASA</b><div id="list-selasa"></div></div>
                <div class="day-card"><b>RABU</b><div id="list-rabu"></div></div>
                <div class="day-card"><b>KAMIS</b><div id="list-kamis"></div></div>
                <div class="day-card"><b>JUMAT</b><div id="list-jumat"></div></div>
                <div class="day-card"><b>SABTU</b><div id="list-sabtu"></div></div>
                <div class="day-card"><b>MINGGU</b><div id="list-minggu"></div></div>
            </div>
        </div>
    </div>

    <div id="shop-modal" class="modal"><div class="modal-content"><h2 style="color: var(--button-pink);">üõçÔ∏è SHOP</h2><div id="shop-items" style="text-align: left;"></div><button onclick="closeModal('shop-modal')" style="width: 100%; margin-top: 10px;">TUTUP</button></div></div>
    <div id="storage-modal" class="modal"><div class="modal-content"><h2 style="color: #3B82F6;">üì¶ STORAGE</h2><div id="storage-items" style="text-align: left;"></div><button onclick="closeModal('storage-modal')" style="width: 100%; margin-top: 10px;">TUTUP</button></div></div>

    <script>
        let candies = parseInt(localStorage.getItem('candies')) || 0;
        let ownedAcc = JSON.parse(localStorage.getItem('ownedAcc')) || ['üéÄ'];
        let foodStock = JSON.parse(localStorage.getItem('food')) || [];
        let currentAcc = localStorage.getItem('currentAcc') || 'üéÄ';
        let isRunning = false;
        let timerObj = null;

        const shopItems = [
            {type:'acc', item:'üëë', name:'Mahkota', price:20},
            {type:'acc', item:'üëí', name:'Topi', price:15},
            {type:'acc', item:'üê∞', name:'Kelinci', price:25},
            {type:'food', item:'üç©', name:'Donat', price:5},
            {type:'food', item:'üç∞', name:'Kue', price:10}
        ];

        function saveAll() {
            localStorage.setItem('candies', candies);
            localStorage.setItem('ownedAcc', JSON.stringify(ownedAcc));
            localStorage.setItem('food', JSON.stringify(foodStock));
            localStorage.setItem('currentAcc', currentAcc);
            ['senin','selasa','rabu','kamis','jumat','sabtu','minggu'].forEach(d => {
                const el = document.getElementById('list-'+d);
                if(el) localStorage.setItem('p-'+d, el.innerHTML);
            });
        }

        function updateUI() {
            document.getElementById('candy-count').innerText = candies;
            document.getElementById('head-accessory').innerText = currentAcc;
            updateModals();
            saveAll();
        }

        function loadData() {
            ['senin','selasa','rabu','kamis','jumat','sabtu','minggu'].forEach(d => {
                const saved = localStorage.getItem('p-'+d);
                if(saved) document.getElementById('list-'+d).innerHTML = saved;
            });
            updateUI();
        }

        function buyItem(idx) {
            let s = shopItems[idx];
            if(s.type === 'acc' && ownedAcc.includes(s.item)) { alert("Sudah punya!"); return; }
            if(candies >= s.price) {
                candies -= s.price;
                if(s.type === 'acc') ownedAcc.push(s.item);
                else foodStock.push(s.item);
                updateUI();
                alert("Berhasil beli! ‚ú®");
            } else { alert("Candies kurang! üç≠"); }
        }

        function updateModals() {
            document.getElementById('shop-items').innerHTML = shopItems.map((s, i) => `
                <div style="display:flex; justify-content:space-between; margin-bottom:8px;">
                    <span>${s.item} ${s.name} (${s.price}üç≠)</span>
                    <button onclick="buyItem(${i})" style="flex:none; padding:2px 10px; font-size:16px;">Beli</button>
                </div>
            `).join('');

            let st = document.getElementById('storage-items');
            st.innerHTML = "<b>AKSESORIS:</b><br>" + ownedAcc.map(acc => `
                <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                    <span>${acc}</span>
                    <button onclick="useAcc('${acc}')" style="flex:none; padding:2px 10px; font-size:16px;">${currentAcc === acc ? 'Dipakai' : 'Pakai'}</button>
                </div>
            `).join('');
            
            let counts = {}; foodStock.forEach(f => counts[f] = (counts[f]||0)+1);
            st.innerHTML += "<br><b>MAKANAN:</b><br>" + Object.keys(counts).map(f => `<div>${f} x${counts[f]}</div>`).join('');
            if(foodStock.length === 0) st.innerHTML += "Kosong";
        }

        function useAcc(acc) { currentAcc = acc; updateUI(); }

        function feedPou() {
            if(foodStock.length > 0) {
                foodStock.shift();
                document.getElementById('pou-character').classList.add('eating');
                showBubble("NYAM! ‚ú®");
                setTimeout(() => document.getElementById('pou-character').classList.remove('eating'), 500);
                updateUI();
            } else { showBubble("Lapar... üç≠"); }
        }

        function handleStart(mode) {
            let mins = parseInt(document.getElementById('custom-min').value);
            if(isNaN(mins) || mins <= 0) { alert("Masukkan menit yang valid!"); return; }
            startTimer(mins, mode);
        }

        function startTimer(min, mode) {
            if(isRunning) return; 
            isRunning = true;
            document.getElementById('btn-study').disabled = true;
            document.getElementById('btn-rest').disabled = true;
            document.getElementById('custom-min').disabled = true;

            let time = min * 60;
            timerObj = setInterval(() => {
                time--;
                let m = Math.floor(time / 60); let s = time % 60;
                document.getElementById('timer-display').innerText = `${m < 10 ? '0'+m : m}:${s < 10 ? '0'+s : s}`;
                
                if(time <= 0) {
                    clearInterval(timerObj);
                    isRunning = false;
                    document.getElementById('btn-study').disabled = false;
                    document.getElementById('btn-rest').disabled = false;
                    document.getElementById('custom-min').disabled = false;
                    document.getElementById('timer-display').innerText = "00:00";

                    if(mode === 'study') {
                        let earned = Math.floor(min / 5);
                        if(earned < 1 && min > 0) earned = 0; // Minimal 5 menit untuk 1 candy
                        candies += earned;
                        updateUI();
                        alert(`Fokus Selesai! Kamu dapat ${earned} üç≠`);
                    } else {
                        alert("Istirahat Selesai! Segar kembali? ‚ú®");
                    }
                }
            }, 1000);
        }

        function addTask() {
            let day = document.getElementById('day-select').value;
            let val = document.getElementById('task-input').value; if(!val) return;
            let div = document.createElement('div');
            div.innerHTML = `‚Ä¢ ${val} <span style="color:red;cursor:pointer;margin-left:5px;" onclick="this.parentElement.remove(); saveAll();">‚úñ</span>`;
            document.getElementById('list-' + day).appendChild(div);
            document.getElementById('task-input').value="";
            saveAll();
        }

        function openModal(id) { updateModals(); document.getElementById(id).style.display = 'flex'; }
        function closeModal(id) { document.getElementById(id).style.display = 'none'; }
        function showBubble(txt) { let b = document.getElementById('bubble'); b.innerText = txt; b.style.display="block"; setTimeout(()=>b.style.display="none", 2000); }

        window.onload = loadData;
    </script>
</body>
</html>